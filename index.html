<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Campus Lunch Survey</title>
  <!-- Updated marketable font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    /* Box Model & Theme Variables */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --primary: #005f73;
      --primary-hover: #0a9396;
      --accent: #ee9b00;
      --bg-overlay: rgba(0,0,0,0.4);
      --bg-light: #ffffffee;
      --text: #333333;
      --label: #555555;
      --radius: 8px;
      --transition: 0.25s;
      --emoji-min: 30px;
      --emoji-max: 50px;
      --shadow: 0 8px 24px rgba(0,0,0,0.1);
    }

    html {
      font-size: 16px;
      -webkit-text-size-adjust: 100%;
      padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
    }

    body {
      font-family: 'Poppins', sans-serif;
      color: var(--text);
      background:
        linear-gradient(var(--bg-overlay), var(--bg-overlay)),
        url('assets/modabackground.png') center/cover fixed no-repeat;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 1rem;
    }

    main {
      width: 100%;
      max-width: 600px;
      margin: auto;
    }

    header {
      background: var(--bg-light);
      padding: 2rem;
      border-radius: var(--radius) var(--radius) 0 0;
      text-align: center;
      box-shadow: var(--shadow);
    }
    .survey-title {
      font-size: 2rem;
      font-weight: 700;
      color: var(--primary);
    }

    form {
      background: var(--bg-light);
      border-radius: 0 0 var(--radius) var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
    }

    .form-section {
      padding: 2rem;
      transition: opacity var(--transition);
    }

    label, legend {
      display: block;
      margin-bottom: 0.75rem;
      font-weight: 500;
      text-align: center;
      color: var(--text);
    }
    fieldset { border: none; margin-bottom: 1.5rem; }

    input[type="date"], textarea {
      width: 100%;
      margin-bottom: 1rem;
      padding: 0.75rem;
      border: 1px solid #ccc;
      border-radius: var(--radius);
      background: #f7f7f7;
      font-size: 1rem;
      color: var(--text);
      transition: border-color var(--transition);
    }
    input[type="date"]:focus, textarea:focus { border-color: var(--primary); outline: none; }
    textarea { min-height: 140px; resize: vertical; }

    .page { display: none; }
    .page.active { display: block; }

    .buttons {
      display: flex;
      gap: 1rem;
      padding: 1rem 2rem 2rem;
      justify-content: center;
      background: var(--bg-light);
      border-top: 1px solid #ddd;
    }
    button {
      background: var(--accent);
      color: #fff;
      border: none;
      padding: 0.75rem 2rem;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      border-radius: var(--radius);
      transition: background var(--transition), transform 0.2s;
    }
    button:hover { background: var(--primary-hover); transform: translateY(-2px); }

    /* Rating Styles */
    .emoji-bar {
      display: flex;
      justify-content: space-between;
      padding: 0 1rem;
      margin-bottom: 1rem;
    }
    .emoji-container {
      background: var(--bg-light);
      border-radius: 50%;
      padding: 0.5rem;
      flex: 1;
      max-width: var(--emoji-max);
      text-align: center;
      transition: background var(--transition);
    }
    .emoji-container.selected, .emoji-container:hover { background: var(--accent); }
    .emoji-container img {
      width: clamp(var(--emoji-min), 10vw, var(--emoji-max));
      display: block;
      margin: auto;
      filter: grayscale(100%);
      transition: transform 0.2s, filter 0.2s;
    }
    .emoji-container.selected img { filter: none; transform: scale(1.1); }
    .emoji-label {
      margin-top: 0.25rem;
      font-size: 0.75rem;
      color: var(--label);
    }

    /* Popup & Confetti */
    #popup {
      display: none;
      position: fixed;
      top: 50%; left: 50%; transform: translate(-50%, -50%);
      background: var(--bg-light);
      padding: 2rem;
      border: 3px solid var(--accent);
      border-radius: var(--radius);
      text-align: center;
      z-index: 10001;
      width: 90%; max-width: 360px;
      box-shadow: var(--shadow);
    }

    /* Mobile-specific Layout */
    @media (max-width: 480px) {
      header { padding: 1.5rem; }
      .survey-title { font-size: 1.75rem; }
      .form-section { padding: 1.5rem; }
      .buttons { flex-direction: column; padding: 1rem; }
      .emoji-bar { gap: 0.5rem; }
    }
  </style>
</head>
<body>
  <main aria-labelledby="surveyWeek">
    <header>
      <h1 id="surveyWeek" class="survey-title"></h1>
    </header>
    <form id="surveyForm">
      <!-- Page 1 -->
      <section class="page active form-section" data-page="date">
        <label for="lunchDate">What day are you reviewing?</label>
        <input type="date" id="lunchDate" name="lunchDate" required>
      </section>
      <!-- Page 2 -->
      <section class="page form-section" data-page="ratings">
        <fieldset>
          <legend>Taste</legend>
          <div class="emoji-bar" id="tasteRating"></div>
          <input type="hidden" id="tasteInput" name="tasteRating" data-label="Taste" required>
        </fieldset>
        <fieldset>
          <legend>Temperature</legend>
          <div class="emoji-bar" id="tempRating"></div>
          <input type="hidden" id="tempInput" name="temperatureRating" data-label="Temperature" required>
        </fieldset>
        <fieldset>
          <legend>Overall</legend>
          <div class="emoji-bar" id="overallRating"></div>
          <input type="hidden" id="overallInput```
